<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Way Kanan Efootball League Season 1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Mengatur font agar lebih bersih dan modern */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        .tab-button.active {
            border-bottom: 3px solid #10b981; /* Warna hijau (Emerald 500) */
            color: #10b981;
            font-weight: 600;
        }
        /* Styling untuk tabel yang responsif */
        .table-container {
            overflow-x: auto;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        th, td {
            white-space: nowrap; /* Mencegah konten tabel wrap */
        }
        .header-cell {
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .header-cell .sort-icon {
            margin-left: 0.25rem;
            transition: transform 0.2s;
        }
        /* Modal Backdrop */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }

        /* Penyesuaian khusus untuk membuat tabel lebih rapat di mobile */
        @media (max-width: 640px) {
            .table-container {
                overflow-x: hidden; /* Sembunyikan scroll jika tidak perlu */
            }
            .klasemen-table th, .klasemen-table td {
                padding-left: 0.5rem; /* px-2 */
                padding-right: 0.5rem; /* px-2 */
            }
            .klasemen-table th:nth-child(2), .klasemen-table td:nth-child(2) {
                /* Kolom Tim lebih lebar */
                padding-left: 0.75rem; /* px-3 */
                padding-right: 0.75rem; /* px-3 */
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-2xl p-4 md:p-8">
        <h1 class="text-3xl font-extrabold text-gray-900 mb-4 text-center">
            <span class="text-emerald-600">WAY KANAN EFOOTBALL LEAGUE</span> Season 1
        </h1>
        
        <!-- Area Admin Login & Status -->
        <div class="flex justify-between items-center mb-6 border-b pb-4">
             <div id="admin-status" class="text-sm font-medium text-gray-600">
                Status: <span id="admin-indicator" class="text-red-500 font-semibold">Bukan Admin</span>
            </div>
            <button id="admin-login-btn" onclick="openLoginModal()" class="px-3 py-1 text-sm font-medium text-white bg-gray-500 rounded-lg hover:bg-gray-600 transition shadow-md">
                Login Admin
            </button>
        </div>

        <!-- Area Tombol Tab -->
        <div class="flex border-b border-gray-200 mb-6">
            <button id="tab-klasemen" class="tab-button active flex-1 py-3 px-1 text-center text-gray-600 hover:text-emerald-600 transition duration-150" onclick="showTab('klasemen-content')">
                Klasemen
            </button>
            <button id="tab-pertandingan" class="tab-button flex-1 py-3 px-1 text-center text-gray-600 hover:text-emerald-600 transition duration-150" onclick="showTab('pertandingan-content')">
                Jadwal & Hasil
            </button>
        </div>

        <!-- Konten Klasemen -->
        <div id="klasemen-content" class="tab-content">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Klasemen Sementara</h2>
            <div class="table-container">
                <table id="klasemen-table" class="min-w-full divide-y divide-gray-200 klasemen-table">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                #
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Tim
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="M">
                                M
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="W">
                                W
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="D">
                                D
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="L">
                                L
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="GF">
                                GF
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="GA">
                                GA
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider" data-sort-by="GD">
                                GD
                            </th>
                            <th scope="col" class="header-cell px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider active-sort" data-sort-by="Pts">
                                Pts
                                <span class="sort-icon">&#9660;</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="klasemen-body" class="bg-white divide-y divide-gray-200">
                        <!-- Data Klasemen akan di-inject di sini -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Konten Pertandingan -->
        <div id="pertandingan-content" class="tab-content hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Jadwal & Hasil Pertandingan</h2>
            
            <!-- Dropdown untuk memilih Babak (di mobile) -->
            <div class="md:hidden mb-4">
                <label for="round-select" class="block text-sm font-medium text-gray-700 mb-1">Pilih Babak</label>
                <select id="round-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md shadow-sm">
                    <!-- Opsi akan di-generate di sini -->
                </select>
            </div>

            <!-- Area Tab Babak (di desktop) -->
            <div id="round-tabs" class="hidden md:flex flex-wrap border-b border-gray-200 mb-4">
                <!-- Tombol Babak akan di-generate di sini -->
            </div>

            <!-- Konten Pertandingan per Babak -->
            <div id="matches-container" class="space-y-4">
                <!-- Detail Pertandingan akan di-inject di sini -->
            </div>
        </div>
    </div>
    
    <!-- Modal Login Admin (Tersembunyi secara default) -->
    <div id="login-modal" class="modal-backdrop hidden">
        <div class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm mx-4">
            <h3 class="text-xl font-bold text-gray-800 mb-4">Akses Admin</h3>
            <p id="login-message" class="text-sm text-red-500 mb-3 hidden">Password salah!</p>
            
            <div class="space-y-4">
                <label for="admin-password" class="block text-sm font-medium text-gray-700">Password</label>
                <input type="password" id="admin-password" onkeydown="if(event.key === 'Enter') attemptLogin()" class="w-full border-2 border-gray-300 rounded-lg p-3 focus:border-emerald-500 focus:ring-emerald-500" placeholder="Masukkan password admin" />
            </div>
            
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeLoginModal()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition">
                    Batal
                </button>
                <button onclick="attemptLogin()" class="px-4 py-2 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 transition shadow-md">
                    Login
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Input Skor (Tersembunyi secara default) -->
    <div id="score-modal" class="modal-backdrop hidden">
        <div class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm mx-4">
            <h3 class="text-xl font-bold text-gray-800 mb-4" id="modal-title">Input Skor Pertandingan</h3>
            
            <div class="space-y-4">
                <div class="flex justify-between items-center">
                    <label id="team1-label" class="font-semibold text-gray-700 w-1/2 pr-2 truncate">Tim 1</label>
                    <input type="number" id="score1-input" min="0" value="0" class="w-1/4 text-center border-2 border-gray-300 rounded-lg p-2 focus:border-emerald-500 focus:ring-emerald-500" />
                </div>
                
                <div class="flex justify-between items-center">
                    <label id="team2-label" class="font-semibold text-gray-700 w-1/2 pr-2 truncate">Tim 2</label>
                    <input type="number" id="score2-input" min="0" value="0" class="w-1/4 text-center border-2 border-gray-300 rounded-lg p-2 focus:border-emerald-500 focus:ring-emerald-500" />
                </div>
            </div>
            
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeModal()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition">
                    Batal
                </button>
                <button onclick="saveScore()" class="px-4 py-2 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 transition shadow-md">
                    Simpan Hasil
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- KONFIGURASI DAN DATA LIGA ---
        // Password Admin (Ganti dengan password yang kuat)
        const ADMIN_PASSWORD = "wkef"; // Contoh password: Way Kanan Efootball

        let isAdmin = false; // Status admin
        
        // Data Klasemen Awal
        const initialKlasemenCSV = `Tim,M,W,D,L,GF,GA,GD,Pts
Riders,1,1,0,0,3,0,3,3
Gusmurtad,1,1,0,0,4,3,1,3
Arief,1,1,0,0,3,2,1,3
Ptangpteng,1,1,0,0,3,2,1,3
Ipangopen,0,0,0,0,0,0,0,0
Tuku Pulsa Tsel,1,0,0,1,3,4,-1,0
Bayu,1,0,0,1,2,3,-1,0
Dexulmantap,1,0,0,1,2,3,-1,0
The Familia FC,1,0,0,1,0,3,-3,0`;

        // Data Pertandingan Awal
        const initialPertandinganCSV = `Babak,Match,Tim 1,Skor 1,Tim 2,Skor 2,Bye
1,1,Arief,3,Dexulmantap,2,
1,2,Bayu,2,Ptangpteng,3,
1,3,Tuku Pulsa Tsel,3,Gusmurtad,4,
1,4,The Familia FC,0,Riders,3,
1,,,,,,Ipangopen
2,5,Ipangopen,,Riders,,
2,6,Arief,,Gusmurtad,,
2,7,Ptangpteng,,Tuku Pulsa Tsel,,
2,8,Dexulmantap,,The Familia FC,,
2,,,,,,Bayu
3,9,Ipangopen,,Arief,,
3,10,Bayu,,Gusmurtad,,
3,11,Ptangpteng,,Riders,,
3,12,Tuku Pulsa Tsel,,The Familia FC,,
3,,,,,,Dexulmantap
4,13,Ipangopen,,Bayu,,
4,14,Arief,,Ptangpteng,,
4,15,Gusmurtad,,The Familia FC,,
4,16,Dexulmantap,,Riders,,
4,,,,,,Tuku Pulsa Tsel
5,17,Ipangopen,,Ptangpteng,,
5,18,Bayu,,The Familia FC,,
5,19,Arief,,Tuku Pulsa Tsel,,
5,20,Gusmurtad,,Dexulmantap,,
5,,,,,,Riders
6,21,Ipangopen,,Tuku Pulsa Tsel,,
6,22,Bayu,,Riders,,
6,23,Arief,,The Familia FC,,
6,24,Gusmurtad,,Ptangpteng,,
6,,,,,,Dexulmantap
7,25,Ipangopen,,Gusmurtad,,
7,26,Bayu,,Tuku Pulsa Tsel,,
7,27,Arief,,Riders,,
7,28,Dexulmantap,,Ptangpteng,,
7,,,,,,The Familia FC
8,29,Ipangopen,,Dexulmantap,,
8,30,Bayu,,Arief,,
8,31,Gusmurtad,,Riders,,
8,32,Tuku Pulsa Tsel,,Ptangpteng,,
8,,,,,,The Familia FC
9,33,Ipangopen,,The Familia FC,,
9,34,Bayu,,Dexulmantap,,
9,35,Arief,,Ptangpteng,,
9,36,Gusmurtad,,Tuku Pulsa Tsel,,
9,,,,,,Riders`;

        let klasemenData = [];
        let pertandinganData = {};
        let currentSort = { column: 'Pts', direction: 'desc' };
        let activeRound = 1;
        let activeMatch = null; 

        // --- FUNGSI UTILITAS DATA & KLASIFIKASI ---
        
        function parseCSV(csvString) {
            const lines = csvString.trim().split('\n');
            if (lines.length === 0) return [];
            
            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.trim());
                if (values.length !== headers.length) continue;

                const row = {};
                headers.forEach((header, index) => {
                    const numericHeaders = ['M', 'W', 'D', 'L', 'GF', 'GA', 'GD', 'Pts', 'Babak', 'Match', 'Skor 1', 'Skor 2'];
                    if (numericHeaders.includes(header) && values[index] !== '' && !isNaN(values[index])) {
                        row[header] = parseInt(values[index], 10);
                    } else {
                        row[header] = values[index];
                    }
                });
                data.push(row);
            }
            return data;
        }

        function resetKlasemen(initialData) {
            return initialData.map(tim => ({
                Tim: tim.Tim,
                M: 0, W: 0, D: 0, L: 0,
                GF: 0, GA: 0, GD: 0,
                Pts: 0
            }));
        }

        function calculateKlasemen() {
            const initialKlasemen = parseCSV(initialKlasemenCSV);
            klasemenData = resetKlasemen(initialKlasemen);
            const klasemenMap = klasemenData.reduce((map, tim) => {
                map[tim.Tim] = tim;
                return map;
            }, {});

            const allMatches = Object.values(pertandinganData).flat();

            allMatches.forEach(match => {
                if (match['Tim 1'] && match['Tim 2'] && match['Skor 1'] !== '' && match['Skor 2'] !== '') {
                    const tim1 = klasemenMap[match['Tim 1']];
                    const tim2 = klasemenMap[match['Tim 2']];
                    const skor1 = match['Skor 1'];
                    const skor2 = match['Skor 2'];

                    if (!tim1 || !tim2) return; 

                    tim1.M += 1;
                    tim1.GF += skor1;
                    tim1.GA += skor2;

                    tim2.M += 1;
                    tim2.GF += skor2;
                    tim2.GA += skor1;

                    if (skor1 > skor2) {
                        tim1.W += 1; tim1.Pts += 3; tim2.L += 1;
                    } else if (skor2 > skor1) {
                        tim2.W += 1; tim2.Pts += 3; tim1.L += 1;
                    } else {
                        tim1.D += 1; tim1.Pts += 1; tim2.D += 1; tim2.Pts += 1;
                    }
                }
            });

            klasemenData.forEach(tim => {
                tim.GD = tim.GF - tim.GA;
            });

            renderKlasemen();
        }

        function initializeData() {
            const matchesArray = parseCSV(initialPertandinganCSV);
            
            matchesArray.forEach(match => {
                const babak = match.Babak;
                if (!pertandinganData[babak]) {
                    pertandinganData[babak] = [];
                }
                // Pastikan Skor 1 dan Skor 2 adalah integer (0 jika string kosong)
                match['Skor 1'] = match['Skor 1'] !== '' ? parseInt(match['Skor 1'], 10) : '';
                match['Skor 2'] = match['Skor 2'] !== '' ? parseInt(match['Skor 2'], 10) : '';

                pertandinganData[babak].push(match);
            });
            
            if (Object.keys(pertandinganData).length > 0) {
                activeRound = Math.min(...Object.keys(pertandinganData).map(Number));
            }

            calculateKlasemen();
        }

        // --- FUNGSI RENDERING UI ---

        function updateAdminStatus(isLoggedIn) {
            const indicator = document.getElementById('admin-indicator');
            const loginBtn = document.getElementById('admin-login-btn');
            
            if (isLoggedIn) {
                indicator.textContent = "Admin Aktif";
                indicator.classList.remove('text-red-500');
                indicator.classList.add('text-emerald-600');
                loginBtn.textContent = "Logout Admin";
                loginBtn.classList.remove('bg-gray-500', 'hover:bg-gray-600');
                loginBtn.classList.add('bg-red-500', 'hover:bg-red-600');
            } else {
                indicator.textContent = "Bukan Admin";
                indicator.classList.remove('text-emerald-600');
                indicator.classList.add('text-red-500');
                loginBtn.textContent = "Login Admin";
                loginBtn.classList.remove('bg-red-500', 'hover:bg-red-600');
                loginBtn.classList.add('bg-gray-500', 'hover:bg-gray-600');
            }
        }
        
        function renderKlasemen() {
            const tbody = document.getElementById('klasemen-body');
            if (!tbody) return;
            tbody.innerHTML = '';

            sortKlasemen(klasemenData);
            
            klasemenData.forEach((tim, index) => {
                const row = document.createElement('tr');
                row.className = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';

                let rankClass = '';
                if (index < 4) {
                    rankClass = 'font-bold text-white bg-emerald-500 rounded-lg shadow-sm';
                }

                // Menggunakan kelas px-2 untuk sel data agar lebih rapat
                row.innerHTML = `
                    <td class="px-2 py-2 text-sm text-center">
                        <span class="w-6 h-6 inline-flex items-center justify-center ${rankClass}">${index + 1}</span>
                    </td>
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 truncate max-w-[80px]">${tim.Tim}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500">${tim.M}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500">${tim.W}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500">${tim.D}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500">${tim.L}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500">${tim.GF}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500">${tim.GA}</td>
                    <td class="px-2 py-2 text-sm text-center text-gray-500 font-semibold">${tim.GD > 0 ? '+' : ''}${tim.GD}</td>
                    <td class="px-2 py-2 text-sm text-center font-bold text-emerald-600">${tim.Pts}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function sortKlasemen(data) {
            const { column, direction } = currentSort;
            
            data.sort((a, b) => {
                const aVal = a[column];
                const bVal = b[column];

                let comparison = 0;
                if (aVal > bVal) comparison = 1;
                else if (aVal < bVal) comparison = -1;

                const primarySort = direction === 'asc' ? comparison : comparison * -1;
                
                if (primarySort !== 0) {
                    return primarySort;
                }

                const gdA = a.GD; const gdB = b.GD;
                if (gdB !== gdA) return gdB - gdA;

                const gfA = a.GF; const gfB = b.GF;
                if (gfB !== gfA) return gfB - gfA;

                return a.Tim.localeCompare(b.Tim);
            });
        }

        function handleSort(event) {
            const header = event.currentTarget;
            const column = header.getAttribute('data-sort-by');
            
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'desc'; 
            }

            document.querySelectorAll('.header-cell').forEach(h => {
                h.classList.remove('active-sort');
                const icon = h.querySelector('.sort-icon');
                if (icon) icon.remove();
            });

            header.classList.add('active-sort');
            const icon = document.createElement('span');
            icon.className = 'sort-icon';
            icon.innerHTML = currentSort.direction === 'asc' ? '&#9650;' : '&#9660;';
            header.appendChild(icon);

            renderKlasemen();
        }

        function renderPertandingan() {
            const roundTabs = document.getElementById('round-tabs');
            const roundSelect = document.getElementById('round-select');
            const matchesContainer = document.getElementById('matches-container');
            
            roundTabs.innerHTML = '';
            roundSelect.innerHTML = '';
            matchesContainer.innerHTML = '';

            const rounds = Object.keys(pertandinganData).map(Number).sort((a, b) => a - b);
            
            if (rounds.length === 0) {
                 matchesContainer.innerHTML = '<p class="text-gray-500">Tidak ada data pertandingan yang tersedia.</p>';
                 return;
            }

            if (!rounds.includes(activeRound)) {
                activeRound = rounds[0];
            }

            rounds.forEach(round => {
                const button = document.createElement('button');
                button.className = `flex-1 py-2 px-1 text-center text-sm transition duration-150 rounded-t-lg mx-1 ${round === activeRound ? 'active text-emerald-600 font-semibold border-b-2 border-emerald-600' : 'text-gray-600 hover:bg-gray-50'}`;
                button.innerHTML = `Babak ${round}`;
                button.onclick = () => { setActiveRound(round); };
                roundTabs.appendChild(button);

                const option = document.createElement('option');
                option.value = round;
                option.textContent = `Babak ${round}`;
                if (round === activeRound) {
                    option.selected = true;
                }
                roundSelect.appendChild(option);
            });

            roundSelect.onchange = (e) => setActiveRound(parseInt(e.target.value, 10));

            const currentMatches = pertandinganData[activeRound] || [];

            currentMatches.forEach((match, index) => {
                const matchId = `${match.Babak}-${index}`;
                match.id = matchId; 

                if (match['Tim 1'] && match['Tim 2']) {
                    const isFinished = match['Skor 1'] !== '';
                    const score1 = isFinished ? match['Skor 1'] : '';
                    const score2 = isFinished ? match['Skor 2'] : '';
                    
                    const resultText = isFinished 
                        ? `<span class="font-bold text-emerald-600">${score1}</span> - <span class="font-bold text-emerald-600">${score2}</span>`
                        : `<span class="text-gray-500">vs</span>`;
                    const statusText = isFinished ? 'Selesai' : 'Jadwal';
                    const statusClass = isFinished ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700';
                    
                    let actionButton = '';
                    if (isAdmin) {
                        actionButton = isFinished 
                            ? `<button onclick="openScoreModal('${matchId}')" class="text-xs text-gray-500 hover:text-emerald-600 transition">Ubah Skor</button>`
                            : `<button onclick="openScoreModal('${matchId}')" class="text-xs font-semibold text-white bg-emerald-500 hover:bg-emerald-600 px-3 py-1 rounded-lg transition shadow-sm">Input Skor</button>`;
                    } else {
                        actionButton = `<span class="text-xs text-gray-400">Login admin untuk input</span>`;
                    }

                    const matchCard = `
                        <div class="p-4 bg-white rounded-xl shadow-md border-l-4 border-emerald-500 hover:shadow-lg transition">
                            <div class="text-xs font-semibold text-gray-500 mb-2 flex justify-between items-center">
                                Match #${match.Match}
                                <span class="px-2 py-0.5 text-xs font-medium ${statusClass} rounded-full">${statusText}</span>
                            </div>
                            <div class="flex items-center justify-between text-lg md:text-xl mb-3">
                                <span class="font-semibold text-gray-800 w-1/3 text-right truncate pr-2">${match['Tim 1']}</span>
                                <span class="w-1/3 text-center mx-1">${resultText}</span>
                                <span class="font-semibold text-gray-800 w-1/3 text-left truncate pl-2">${match['Tim 2']}</span>
                            </div>
                            <div class="flex justify-end">
                                ${actionButton}
                            </div>
                        </div>
                    `;
                    matchesContainer.innerHTML += matchCard;
                } else if (match.Bye) {
                    const byeCard = `
                        <div class="p-4 bg-gray-100 rounded-xl shadow-md border-l-4 border-gray-400">
                            <div class="flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1-9a1 1 0 000 2h2a1 1 0 100-2h-2z" clip-rule="evenodd" />
                                </svg>
                                <span class="text-md font-medium text-gray-700">
                                    ${match.Bye} <span class="text-gray-500 font-normal">(BYE - Tidak bertanding)</span>
                                </span>
                            </div>
                        </div>
                    `;
                    matchesContainer.innerHTML += byeCard;
                }
            });
        }

        function setActiveRound(round) {
            activeRound = round;
            document.querySelectorAll('#round-tabs button').forEach(btn => {
                const isSelected = parseInt(btn.textContent.split(' ')[1], 10) === round;
                btn.classList.toggle('active', isSelected);
                btn.classList.toggle('text-emerald-600', isSelected);
                btn.classList.toggle('font-semibold', isSelected);
                btn.classList.toggle('border-b-2', isSelected);
                btn.classList.toggle('border-emerald-600', isSelected);
                btn.classList.toggle('text-gray-600', !isSelected);
            });
            const roundSelect = document.getElementById('round-select');
            if (roundSelect) {
                roundSelect.value = round;
            }
            renderPertandingan();
        }

        function showTab(contentId) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });

            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });

            document.getElementById(contentId).classList.remove('hidden');

            document.getElementById(`tab-${contentId.replace('-content', '')}`).classList.add('active');

            if (contentId === 'klasemen-content') {
                 calculateKlasemen();
            }
        }
        
        // --- LOGIKA OTENTIKASI ADMIN ---

        function openLoginModal() {
            if (isAdmin) {
                // Jika sudah login, lakukan logout
                logoutAdmin();
            } else {
                // Jika belum login, buka modal
                document.getElementById('login-modal').classList.remove('hidden');
                document.getElementById('admin-password').value = '';
                document.getElementById('login-message').classList.add('hidden');
                document.getElementById('admin-password').focus();
            }
        }

        function closeLoginModal() {
            document.getElementById('login-modal').classList.add('hidden');
        }

        function attemptLogin() {
            const password = document.getElementById('admin-password').value;
            const message = document.getElementById('login-message');

            if (password === ADMIN_PASSWORD) {
                isAdmin = true;
                message.classList.add('hidden');
                closeLoginModal();
                updateAdminStatus(true);
                renderPertandingan(); // Render ulang untuk menampilkan tombol input
            } else {
                message.textContent = "Password salah! Silakan coba lagi.";
                message.classList.remove('hidden');
            }
        }
        
        function logoutAdmin() {
            isAdmin = false;
            updateAdminStatus(false);
            renderPertandingan(); // Render ulang untuk menyembunyikan tombol input
        }

        // --- LOGIKA MODAL INPUT SKOR ---
        
        function openScoreModal(matchId) {
            if (!isAdmin) {
                // Logika keamanan: pastikan hanya admin yang bisa membuka modal skor
                console.warn("Akses ditolak: Hanya admin yang dapat memasukkan skor.");
                return;
            }

            const [round, index] = matchId.split('-');
            const match = pertandinganData[parseInt(round)][parseInt(index)];
            
            activeMatch = match;

            document.getElementById('modal-title').textContent = `Input Skor Babak ${match.Babak} Match ${match.Match}`;
            document.getElementById('team1-label').textContent = match['Tim 1'];
            document.getElementById('team2-label').textContent = match['Tim 2'];

            document.getElementById('score1-input').value = match['Skor 1'] !== '' ? match['Skor 1'] : 0;
            document.getElementById('score2-input').value = match['Skor 2'] !== '' ? match['Skor 2'] : 0;

            document.getElementById('score-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('score-modal').classList.add('hidden');
            activeMatch = null;
        }

        function saveScore() {
            if (!activeMatch) {
                console.error("Tidak ada pertandingan aktif.");
                closeModal();
                return;
            }

            const score1 = parseInt(document.getElementById('score1-input').value, 10);
            const score2 = parseInt(document.getElementById('score2-input').value, 10);

            if (isNaN(score1) || isNaN(score2) || score1 < 0 || score2 < 0) {
                 console.error("Input skor tidak valid. Pastikan skor adalah angka positif.");
                 return;
            }

            activeMatch['Skor 1'] = score1;
            activeMatch['Skor 2'] = score2;
            
            closeModal();

            // Render ulang tab pertandingan dan hitung ulang klasemen
            renderPertandingan(); 
            calculateKlasemen();
        }

        // --- Inisialisasi Aplikasi ---
        window.onload = function() {
            initializeData();
            
            // Atur event listener untuk sorting
            document.querySelectorAll('.header-cell').forEach(header => {
                header.addEventListener('click', handleSort);
            });
            
            // Set status admin awal
            updateAdminStatus(isAdmin); 

            // Render data awal
            renderPertandingan();
        };
    </script>
</body>
</html>

